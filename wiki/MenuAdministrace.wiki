#summary Menu administrátorských procesů
<wiki:toc max_depth="1" />

==Long running processes manager==

Otevře okno se seznam všech procesů, které kdy byly spuštěny, defaultně seřazené podle času spuštění sestupně, takže na první stránce vidíte nejčerstvější procesy. Kliknutím na hlavičku sloupce se podle něj  řadí. 
Kliknutím na název procesu otevřete v samostatném okně detailní informace o jeho běhu. Defaultně to jsou systémové logy. Některé typy procesů ale mohou mít místo logů vlastní typ výstupu - to je případ procesu Replikace, kde je seznam úspěšně a neúspěšně importovaných titulů.

==Import of monographs, Import of periodicals== 

Spustí replikaci monografií nebo titulů, podle obsahu souboru monographs.txt nebo periodicals.txt . Umístění a názvy těchto souborů jsou definovány v souboru .kramerius4/migration.properties, tam je definován i pracovní adresář (musí existovat, je vyprázdněn před každým importem titulu nebo ročníku) a také údaje pro připojení ke starému krameriovi.

==Document`s indexation== 

Otevře seznam všech titulů pro indexaci,  vlevo můžete kliknout na typ monograph nebo periodical, vpravo se objeví příslušný seznam, kliknutím na titul spustíte jeho indexaci, po ukončení indexace je titul vyhledatelný v uživatelském GUI. Kliknutím na položku index vedle přepínače typů spustíte indexaci všech titulů daného typu

==Enumerator==

Připojí se k databázi starého krameria a do souborů monographs.txt a periodicals.txt vypíše její kompletní obsah (interní ID pro monografie, ISSN a ročník pro periodika - toto jsou údaje, se kterými umí pracovat replikační rozhraní K3). Vytvořené soubory můžete přejmenovat a rozdělit na menší kusy a řídit tak, po jakých  úsecích se bude replikovat příkazem Import.... Vždy se replikuje vše, co je v souboru monographs.txt, resp. periodicals.txt.

==Replication rights== 

Nastaví v K3 přístupová práva ke všem dokumentům pro replikační instituci, jejíž sigla je uvedena v migration.properties. Tento příkaz stačí spustit jen jednou před první replikací. Každé další spuštění už neudělá nic, jen si do logu bude stěžovat, že se mu do databáze nepodařilo zapsat duplicitní údaj.

=Procesy v systému Kramerius=
Pro dlouho trvající akce má system kramerius definován termín dlouhotrvající procesy. Spouští se jako standardní systémové procesy a lze je spravovat systemovými prodstředky (ps, kill, top, apod.). Vždy se jedná o java programy. 

===Definice procesu===
Všechny procesy jsou definovány ve speciálním xml souboru (který je uživatelsky rozšiřitelný - uživatel může definovat vlastní procesy případně předefinovavat existující). V definicích procesu jsou všechny náležitosti potřebné ke spuštění. Ukázka definice procesu:
{{{
<process>
		<!-- Identifikator procesu -->
		<id>replikator_monographs</id>
		<description> ... </description>
		<mainClass>org.kramerius.Replicate</mainClass>
		<standardOs>lrOut</standardOs>
		<errOs>lrErr</errOs>
		<!-- Parametry predavane JVM -->		
		<javaProcessParameters>-Xmx512m -Xms256m</javaProcessParameters>
		<!-- Parametry predavane samotnemu procesu -->
		<parameters>monographs</parameters>
		...
</process>
}}}


===Manipulace s procesy===

Pro spuštení procesu se používá řídici servlet *lr*, který krom spuštění může ještě procesy vypínat, vypisovat případně měnit jméno. Syntaxe použití je následující:

{{{<server_host:port>/search/lr?action=[start|stop|updateName][otherActionParams]}}}

 * parametr definuje akci, která se má stát, 
 * parametr otherActionParams pak závisí na zvolené akci. 


====Spuštění procesu==== 

Spuštění procesu má nasledující syntaxi: 
{{{<server_host:port>/search/lr?action=start&def=<def_id_procesu>&params=<runtime_params>}}}

 * *start*  Parametr proces spustí případně naplánuje na spuštění. To se řídí aktualním počtem pravě bežících procesů. 
 * *def*  ID procesu, který se má spustit.	
 * *params* Tzv. runtime parametry procesu. Před spuštěním se "slejou" parametry definované v xml souboru s runtime parametry do jednoho pole. To pak reprezentuje spouštěcí parametry procesu.


====Spuštení vybraných procesů====

=====Replikace monografií===== 
{{{<server_host:port>/search/lr?action=start&def=replikator_monographs}}}

=====Replikace periodik===== 
{{{<server_host:port>/search/lr?action=start&def=replikator_periodicals}}} 

=====Reindexace objektu===== 
{{{<server_host:port>/search/lr?action=start&def=reindex&out=text&params=fromKrameriusModel,<uuidObjektu>,<titulek_procesu>}}} 

=====Smazání objektu===== 
{{{<server_host:port>/search/lr?action=start&def=delete&out=text&params=<uuidObjektu>,<cestaUUIDodKorene> }}} 
 * Parametr *cestaUUIDodOkrene* reprezentuje seznam uuid objektů od kořenového objektu až po ten, který se má smazat. Jako oddělovač cesty je použitý znak */*. 

=====Nastavení viditelnosti na public===== 
{{{<server_host:port>/search/lr?action=start&def=setpublic&out=text&params=<uuidObjektu>}}}

=====Nastavení viditelnosti na private===== 
{{{<server_host:port>/search/lr?action=start&def=setprivate&out=text&params=<uuidObjektu>}}}


====Zastavení procesu====

Syntaxe je následující: 
{{{<application>/lr?action=stop&uuid=<uuidProcesu>}}} 
  * *uuidProcesu* je identifikator procesu přiřazovaný akcí start.