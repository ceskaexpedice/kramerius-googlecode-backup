#summary Přehled změn v jednotlivých verzích
<wiki:toc max_depth="1" />

=Pracovní verze (trunk)=

=Verze 4.4.0 (beta2)=
 
  * Issue 125 - Možnost zablokování uživatelského účtu
  * Issue 174 - Opravena chybná konverze ISSN v Monograph/Series
  * Issue 162 - Doplněn chybějící scrollbar v úvodních informacích
  * Issue 147 - Doplněna lišta pro druhou úroveň dokumentů v seznamu vyhledaných
  * Issue 130 - Opravena chyba v chování pásu náhledů
  * Issue 107 - Položka Editor dostupná pro všechny úrovně objektů
  * Issue 95 - Signalizace průběhu vyhledávání
  * Issue 165 - Změněn způsob zadávání IP filteru v editoru práv
  * Issue 140 - Podpora Shibbolethu
  * Issue 166 - Podpora Fedory 3.5
  * Issue 164 - Tisk do fronty na serveru
  * Issue 148, 145, 137, 120, 108, 102 - Zlepšení indexace
  * Issue 142, 133, 155 - Vylepšeno zobrazení informací o procesech
  * Issue 152 - Podpora dokumentů s více typy
  * Issue 93 - Nová podoba navigačního panelu
  * Issue 97 - Konfigurovatelné panely metadat
  * Issue 90 - Automatické načítání další stránky výsledků při skrolování
  * Issue 88 - Opraveny chyba v chování posuvníku časové osy
  * Issue 18 - Změna zobrazování výsledků vyhledávání 
  * Issue 113 - Opraven problém s vytvářením prázdných tabulek správy procesů
  * Konvertor K3->K4 umožňuje automatickou konverzi obrázků v plném rozlišení do JPG (property convert.originalToJPG=true)

=Verze 4.3.5 (r2693)=

  * Issue 153 - přidána možnost záložky se zobrazením obsahu streamu TEXT_OCR (aktivace pomocí search.properties, klíč search.item.tabs=text_ocr)
  * Opraveno zobrazování rámečků pro data ALTO s českými řetězci
  * Indexace dokumentů (z hlavního menu) vždy nejdříve smaže existující položky v indexu 

=Verze 4.3.3 (r2630)=

Distribuční zip soubor je k dispozici v sekci  [http://code.google.com/p/kramerius/downloads/detail?name=Kramerius-4.3.3.zip Downloads] ,  při aktualizaci z předchozí verze nakopírujte soubory search.war, rightseditor.war a editor.war do adresáře tomcat/webapps. Soubor security-core.jar do adresáře tomcat/lib. Soubor schema.xml do adresáře fedora/solr/conf

  * Issue 146 - opravena chyba při zobrazení informace o private dokumentu
  * Issue 77 - podpora session timeout 
  * Issue 141 - Zlepšené nastavení replikačních práv pro konvertor K3->K4
  * Issue 123 - XSL šablony pro transformaci MODS v konvertoru K3->K4 mohou být předefinovány v adresáři .kramerius4/xsl
  * Opravena reindexace po změně viditelnosti nebo smazání části dokumentu
  * Issue 135 -	Možnost nastavení výchozích přístupových práv replikovaných monografií (property convert.defaultRights)
  * Issue 127 -	Podpora ALTO 1.4 a 2.0 v konvertoru K3->K4, indexaci i zobrazování
  * Issue 122 - Opravena chyba v zobrazování náhledů v editoru vazeb
  * Issue 118 - Opraven problém při konverzi externě referencovaných souborů
  * Issue 103 - Podpora e-knih (souborů pouze pro download)
  * Issue 106 - Opravena chyba: Internet Explorer 9 - správa dlouhotrvajících procesů - aktualizace
  * Issue 116 - opravena chyba při rušení plánovaných procesů
  * Issue 115, 104 - Zlepšeno hlášení chyb v procesech
  * Issue 112 - oprava XSLT šablony pro OAI ESE
  * Issue 49 - Uživatelsky definovatelné podmínky přístupových práv (skripty)
  * Issue 94 - opraveny defaultní XSLT šablony pro metadata
  * Issue 99 - Přihlašovací dialog obsahuje konfigurovatelný text (konfigurační soubor logininfo, případně v jazykových mutacích logininfo_CZ_cs, logininfo_EN_en atd...)
  * Issue 101 - Dílčí úpravy v XSLT šablonách MODS v konvertoru K3->K4
  * Issue 100 - Odstraněna nefunkční položka "odkazy" v hlavičce stránky. Odkazy mohou  být uvedeny v záložce Informace 
  * Issue 98 - Úpravy defaultních popisek prvků UI (podle schůze 18.4.)
  * Issue 92 - Konfigurace počtu rozbalených položek v seznamu (property search.results.numOpenedRows=3)
  * Issue 91 - Nová záložka na titulní stránce - Vybrané. Její obsah je definován seznamem PID v property search.home.tab.custom.uuids. (PID musí být uvedeny včetně prefixu uuid:) Možnost konfigurovat pořadí záložek na titulní stránce (property search.home.tabs=custom,info,newest,mostDesirables)
  * Issue 89 - konfigurovtelný počet výsledků vyhledávání na stránce (property search.results.rows=15)
  * Sjednoceny servlety pro práci s obrázky
  

=Verze 4.3.1 (r2385)=

  * Opraveno chybné zobrazení stran uložených v  IIP image serveru.
  * Úpravy v podpoře OAI (tag OAI:itemId nastavován konvertorem pro všechny modely, nový exportní formát drkramerius4 pro registr digitalizace)

=Verze 4.3.0 (r2376)=

  * Issue 57 - opraveno našeptávání u vyhledávání podle autora
  * Issue 56 - vylepšeno sestavení nadpisu na úvodní stránce generovaného PDF
  * Issue 60 - administrátorské procesy logují do stdout místo stderr
  * Issue 22, Issue 76 - administrátorem editovatelný systém XSLT šablon pro zobrazení metadat. Defaultní XSLT šablony pro zobrazení MODS v jednotlivých částech stránek jsou definovány v adresářích `search/web/inc/details/xsl` a `search/web/inc/results/xsl`. Kteroukoli z šablon je možno nahradit vlastní, uloženou pod stejným názvem (bez cesty) v adresáři `~/.kramerius4/xsl`.
  * Issue 74 - konvertor K3->K4 - podpora zdrojového a cílového souboru na různých filesystémech
  * Issue 73 - konvertor K3->K4 ukládá foxml soubory do podadresáře xml (při konverzi do adresářů podle zakázek)
  * Issue 47 - opravena chyba při automatickém spouštění indexace po mazání dokumentu
  * Indexer - přidány nové akce: checkIntegrityByModel, checkIntegrityByDocument
  * Issue 75, Issue 68 - opraveny nekozistence při navigaci stromem dokumentů pomocí pop-up menu v pravém panelu  
  * Issue 80 - opravena chyba při mazání titulů s vícenásobnými vazbami
  * Issue 61 - při generování PDF se nezadává požadovaný rozsah stran, ale jen počet stran od aktuálně vybrané. Odpadá tím problém s nejednoznačným číslováním stran.
  * Issue 83 - opravena chyba v přesměrování při zadání persistentního URL dokumentu
  * Issue 82 - při požadavku na zobrazení dokumentu s neexistujícím UUID je zobrazena úvodní stránka doplněná o chybovou zprávu 
  * Issue 50 - podpora aktuální verze Fedory 3.4.2
  * Odstraněna nutnost připojení k databázi fedora3. Z konfiguračního souboru Tomcat je možno odstranit příslušný datasource.
  * Issue 69 - opravena chyba při zobrazování internalPart (K4 vyžadoval existenci streamu IMG_FULL)
  * Issue 81 - konvertor K3->K4 při při konverzi do adresářů podle zakázek kopíruje i původní XML ve formátu K3. Řízeno příznakem `convert.copyOriginal=true` v migration.properties
  * Issue 70 - konvertor K3->K4 při konverzi dokumentu s chybějícím obrázkovým souborem je konverze ukončena s výjimkou IllegalStateException. Původní chování (vytvořen FOXML objekt bez obrázku a konverze pokračuje) je možno nastavit pomocí property `convert.ignoreMissingFiles=true`.
  * Issue 79 - konvertor K3->K4: opravy a optimalizace XSLT šablon pro datastream BIBLIO-MODS
  * Issue 37 - při generování PDF je omezen počet současně zpracovávaných požadavků, při překročení může uživatel požadavek opakovat. Maximální počet požadavků je řízen položkou  `pdfQueue.activeProcess` v configuration.properties (výchozí hodnota 2).
  * Issue 78 - opravena chyba při zapisování uživatele, který spustil proces, do přehledu procesů
  * Licenční text, zobrazovaný u dokumentů s donátorem je přesunut z FOXML objektu s logem donátora do standardního souboru labels.properties. 
  * Issue 86 - opravena chyba v detekci předčasného ukončení procesů
  * Issue 85 - doplněna optimalizace indexu po smazání záznamu. Existující nekonzistence v indexech budou automaticky opraveny jakémkoli dalším mazání dokumentů, případně je lze vynutit okamžitě zadáním URL `http://localhost:8080/solr/update?stream.body=optimize`
  * Issue 67 - editor pořadí stránek se otevírá v novém okně, odstraněn zpětný odkaz do K4 
  * OAI - nový provider pro Registr digitalizace, optimalizace stávajícího provideru ESE. Při použití OAI je třeba nainstalovat příslušné disseminátory a aktuální verzi FOXML modelů z distribučního souboru installation.zip


=Verze 4.2.3 (2168)=

_Poznámka:_ Při upgrade z verze 4.2.1 je třeba nahradit všechny 4 soubory z `Kramerius-4.2.3.zip` , ze souboru `installation-4.2.3.zip` stačí nahradit soubor `solr/conf/schema.xml`.

  * Issue 34 - opraven email s generovaným heslem
  * Issue 35 - opraveny chyby u záložky Informace
  * Issue 11 - zachování URL po přihlášení
  * Issue 39 - alternativní způsob předání parametrů procesům
  * Issue 40 - podpora PDF v konvertoru K3->K4
  * Issue 36 - proces importer prochází podadresáře v abecedním pořadí
  * Issue 45 - opravena chyba ve zpracování persistentního URL (handle)
  * Issue 44 - URL pro spouštění externích editorů je odvozeno z URL requestu, ne ze systémové property
  * Issue 46 - předávání autentizačních údajů mezi kaskádovitě spouštěnými procesy
  * Issue 38 - vylepšeno chování procesu pro generování cache deepZoom dlaždic
  * Issue 54 - změna názvu parametru v URL pro volání externího editoru metadat
  * Issue 51 - automatické zavírání kontextového menu
  * Issue 52 - opraveno chování lišty pro stránkování ve výsledcích vyhledávání
  * Issue 53 - opravena nefunkční tlačítka stránkování při zobrazení plné velikosti stran
  * Issue 43 - opravena chyba zobrazování velkého náhledu v prohlížečích s jádrem Webkit


=Verze 4.2.1 (2068)=

  * Opravena chyba v nastavování přístupových práv bez parametru
  * Upraven dialog pro generování PDF

=Verze 4.2.0=

  * Issue 33 - v přehledu procesů je zaznamenáván uživatel spouštějící proces 
     (Struktura databázových tabulek je automaticky aktulizována při prvním spuštění K4)

  * Zlepšená podpora uživatelsky definované datové struktury
      nová konfigurační property fedora.treePredicates, opravy v šablonách, kontextovém menu

  * Reindexace dokumentů rekursivně s ohledem na datum importu. Není potřeba reindexovat celý strom, jen tu větev, kde došlo k změně.

  * Možnost reindexace všech dokumentů s daným modelem nejvyší úrovně (např. všechny monografie)

  * Issue 15 - sjednoceno indexování a lokalizace položek ve facetu Typ dokumentu 

  * Issue 32 - pro spuštění procesu mimo GUI je třeba autentizace dle parametru v url

  * Issue 27 - Dialog pro změnu příznaku kramerius:policy obsahuje informaci o tom, jak je aktuálně nastavený  

  * Issue 30 - Prohlížečka Seadragon distribuována jako součást K4

  * Issue 31, Issue 17, Issue 16 - Změna definice procesů v lp.xml nevyžaduje restart aplikace, sjednocena konfigurace logování (všechno logování je přesměrováno na standardní logovací API JDK)

  * Issue 26 - Lokalizace login dialogu

  * Issue 19 - Opraveno zobrazování neobvyklých struktur dokumentů

  * Issue 25 - Odstraněn středník za autorem v seznamu monografií

  * Sjednocen styl uživatelského rozhraní

  * Issue 29 - Nový systém správy uživatelů a přístupových práv
     Popis a způsob použití je v dokumentu [Prava], instalace v [Instalace#Přístupová práva uživatelů] 

     Upozornění: Při přechodu ze starších verzí K4 do tomcat/lib nakopírujte jar s jdbc ovladačem pro postgresql, nejlépe z distribuce databáze PostgreSQL nebo z archivu search.war/WEB-INF/lib  - ovladač z distribuce fedora 3.3 patří k PostgreSQL 8.3 a s Krameriem 4.2 a novějším nefunguje.

  * Issue 28 - Podpora pro obrazové soubory mimo úložiště Fedora (včetně IIP image serveru)
    (zaveden nový literál v RELS-EXT, viz [Instalace])

  * Podpora pro ALTO
     (Soubor s informacemi ALTO se ukládá do datastreamu ALTO, který v tom případě nahrazuje datastream TEXT_OCR)
 
  * Fulltextové vyhledávání v rámci vybraného dokumentu

  * Issue 9 - Opraveny zjištěné problémy GUI v prohlížeči MSIE

  * Konvertor K3 -> K4 umožňuje využití externích odkazů v binárních datastreamech (file URL)
     zavedeny nové properties do migration.properties:
{{{
# target directory for conversion
convert.target.directory=${sys:user.home}/.kramerius4/convert-converted


#target directory for replication and conversion
migration.target.directory=${sys:user.home}/.kramerius4/replication-converted

#convertor will create subfolder with contract name in the conversion target subfolder, the contents of the target directory is not deleted prior conversion batch  
convert.useContractSubfolders=false

# controls how convertor K3->K4 should embed binary streams ( encoded/referenced/external)
convert.files=encoded
# controls how convertor K3->K4 should embed preview streams ( encoded/referenced/external)
convert.previews=encoded
# controls how convertor K3->K4 should embed thumbnail streams ( encoded/referenced/external)
convert.thumbnails=encoded


#ingest and indexing phases of migration processes will be skipped
ingest.skip=false

}}}

  * Generování velkých náhledů a jejich parametrizovaná velikost v konvertoru
     zavedeny nové properties do migration.properties:
{{{
# controls if convertor K3->K4 should generate IMG_PREVIEW
convert.generatePreview=true

# size of the generated preview in pixels (maximum height or width)
convert.previewSize=700
}}}

  * Integrován editor pořadí podřízených částí dokumentu  (tedy RDF vazeb a jejich pořadí v RELS-EXT) 