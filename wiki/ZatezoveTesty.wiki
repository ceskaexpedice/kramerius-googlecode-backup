#summary Popis zátěžových testů v NKP


==Průběžné informace z měření==
===Výchozí stav===
1. Počáteční stav (6350 objektů)
  * otevření titulu : 2.5s
  * vyhledání ze záložky Tituly: 1 s
  * vyhledání  fulltext "zlatá": 1 s
  * document indexation (browse model): 3s

===Úvodní testy===
2. Import ze samostatného procesu bez indexace: 1 dávka (635 objektů) cca 17 s. (37 obj/s) - RI Mulgara

3. Import z dvou paralalně běžících procesů: 1 dávka(1270 objektů) cca 25s (50 obj/s) - RI Mulgara

RI Mulgara při paralelním importu padá kvůli memory leaku, další memory leak se objevoval při použití s OAI providerem. Instalace překonfigurována na použití MPT triplestore. Import opakován:

2a.  Import ze samostatného procesu bez indexace: 1 dávka (635 objektů) cca 30 s. (20 obj/s) - RI MPTStore

3a. Import z dvou paralalně běžících procesů: 1 dávka(1270 objektů) cca 50s (25 obj/s) - RI MPTstore

Při použití indexu MPT store tedy nedochází k memory leakům, ale paralelní import nepřináší prakticky žádné zrychlení a celkově je import téměř 2x pomalejší než při použití RI Mulgara.

===Testy kapacity a odezvy úložiště===
====Objem dat 1M====
Import cca 1M objektů se zapnutým indexem MPT store trval cca 12 hodin.

Rebuild RI MPT store s 1M objektů trval přibližně 20 hodin.

4. Rychlost odezvy GUI při 1M objektů:
  * otevření titulu: 3s
  * vyhledání ze záložky Tituly: 1.5 s
  * vyhledání  fulltext "zlatá": 1 s
  * document indexation (browse model): 2.5s

====Objem dat 6,5M====
5. V průběhu importu po naimportování asi 6.5M objektů byl vyčerpán stávající diskový prostor pro databázi. FOXML objekty ve fedoře zabírají cca 50GB, odpovídající databáze riTriples 130GB. Prostor pro fedoru zvýšen cca na 600GB, pro postgres na cca 900GB. 
Resource index MPTstore se jeví jako neefektivní řešení, Mulgara nefunkční. Bude zkoumána možnost vyžití implementace 4store.org.

Rychlost importu na nové konfiguraci disků mírně vzrostla, 1 dávka (1270 objektů) nyní trvá cca 40s (původně 50s).

====Objem dat 35M====
6. K 29.7.2012 je naimportováno 35M objektů. 
Rychlost importu i odezva GUI K4 zůstává stejná, dotazy do MPT store se výrazně zpomalují, složitější dotaz spojující 3 RDF vazby trvá místo počátečních jednotek vteřin jednotky minut. 
Je třeba provézt opatření a tento typ dotazů nebude v K4 používán.
Databáze MPTStore zabírá cca 850GB, úložiště Fedora cca 300GB

====Objem dat 40M====
7. 5.8.2012 po naimportování 40M objektů byly vyčerpány všechny inodes v datovém úložišti fedora. 
Po navýšení potřebné kapacity inodes na 100 000 000 byla dne 24.8.2012 spuštěna další dávka importu s cílem 48M importovaných objektů.

====Objem dat 48M====
8. 29.8.2012 naimportováno 48M objektů, spuštěna závěrečná dávka importu s cílem 60M. Rychlost importu i odezvy systému se nemění.

===Test indexu SOLR===
Současně s testem kapacity úložiště fedora a MPT store proběhne (původně nepožadovaný) test kapacity indexu SOLR. 
Po indexaci 5M objektů byl vyčerpán dostupný diskový prostor na serveru KSOLRKRAM1, další tsty budou pokračovat po navýšení kapacity administrátory NKČR. 
Stávající rychlost odezvy GUI závislá na indexu SOLR při 5M záznamech se neliší oproti rychlostem uvedeným v bodu 4 pro 1M záznamů. 

===Závěry testů===
Závěru testů a doporučení budou publikovány (pravděpodobně) během měsíce září 2012 